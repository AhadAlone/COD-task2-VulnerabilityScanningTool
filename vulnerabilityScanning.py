import socket
import requests

#scanning ports
def scan_ports(ip, port_range):
    open_ports = []
    for port in port_range:
        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        sock.settimeout(1)
        result = sock.connect_ex((ip, port))
        if result == 0:
            open_ports.append(port)
        sock.close()
    return open_ports

# to get software version
def get_software_versions(url):
    response = requests.get(url)
    server_header = response.headers.get('Server', 'Unknown')
    x_powered_by = response.headers.get('X-Powered-By', 'Unknown')
    return {
        'Server': server_header,
        'X-Powered-By': x_powered_by
    }

# to check directory listing
def check_directory_listing(url):
    response = requests.get(url + '/testdir/')
    if response.status_code == 200 and "Index of" in response.text:
        return True
    return False

# scaning for vulnerabilities
def scan_vulnerabilities(ip, port_range, url):
    print(f"Scanning ports on {ip}...")
    open_ports = scan_ports(ip, port_range)
    print(f"Open ports: {open_ports}")

    print(f"Checking software versions for {url}...")
    software_versions = get_software_versions(url)
    print(f"Software versions: {software_versions}")

    print(f"Checking for directory listing on {url}...")
    dir_listing = check_directory_listing(url)
    if dir_listing:
        print("Directory listing is enabled!")
    else:
        print("Directory listing is disabled.")


ip = input("Enter IP adress: ")
port_range = range(20, 1024)
url = input("Enter URL")
scan_vulnerabilities(ip, port_range, url)
